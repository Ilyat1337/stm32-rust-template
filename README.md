# STM32 Rust Template

## Описание

Шаблон проекта на языке программирования Rust для микроконтроллера `STM32F103RBT6` (отладочная плата `NUCLEO-F103RB`).

[Примеры программ](https://github.com/stm32-rs/stm32f1xx-hal/tree/master/examples)

## Установка (Windows)

1. Скачайте и установите [Docker Desktop](https://www.docker.com/products/docker-desktop/).
2. Склонируйте репозиторий: `git clone https://github.com/Ilyat1337/stm32-rust-template.git`
3. Откройте папку в редакторе [VSCode](https://code.visualstudio.com/download).
4. Нажмите кнопку `Reopen in container` во всплывающем окне или выполните команду `Rebuild and Reopen in Container` (для открытия палитры команд используйте сочетание клавиш `Ctrl + Shift + P`).
5. Дождитесь окончания загрузки. При первом запуске может потребоваться перезапустить редактор, чтобы корректно загрузились необходимые расширения.
6. Чтобы удостовериться, что всё работает корректно, выполните команду `Build (release)` (`Ctrl + Shift + P` -> `Run Task` -> `Build (release)`). Сборка проекта должна завершиться успешно.

## Команды

Проект содержит набор пользовательских команд, необходимых для сборки и запуска программы на микроконтроллере. Для запуска команды используйте `Ctrl + Shift + P` -> `Run Task` -> _Название команды_.

* `Build (debug)` - собирает программу в режиме Debug. Подходит для отладки кода на микроконтроллере.
* `Build (release)` - собирает программу в режиме Release. Подходит для запуска на микроконтроллере или использования в симуляторе Proteus.
* `Clean` - удаляет артефакты сборки. Команду необходимо запускать перед сборкой, если был отредактирован файл _memory.x_.
* `Upload` - загружает программу на микроконтроллер. Требует дополнительной настройки на стороне основной операционной системы (Windows).

Ко всем перечисленным командам также можно получить используя сочетание клавиш `Ctrl + Shift + B`.

## Отладка

На данный момент отладка возможно только на реальном микроконтроллере (отладка в Proteus не поддерживается).

Установите точки остановы в редакторе, после чего запустите отладку нажатием клавиши `F5`. Максимальное количество точек остановы - 5. Отладка требует дополнительной настройки на стороне основной операционной системы (Windows).

## Симуляция в Proteus

При создании проекта в Proteus выбирайте микроконтроллер `STM32F103R6`.

Скомпилируйте проект в режиме Release (команда `Build (release)`). В Proteus двойным щелчком мыши по микроконтроллеру откройте его конфигурацию. Выберите файл с программой. Он находится по следующему пути: _target/thumbv7m-none-eabi/release/program.elf_.
